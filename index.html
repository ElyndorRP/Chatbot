<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mega Assistant Lyc√©e + Quiz</title>
<style>
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  color:#eee;
  margin:0;
  padding:0;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
}
#app {
  width:95%;
  max-width:1000px;
  background: rgba(30,30,30,0.95);
  border-radius:20px;
  box-shadow:0 8px 25px rgba(0,0,0,0.6);
  padding:20px;
  display:flex;
  flex-direction:column;
  animation:fadeIn 1s ease;
}
h1 {
  text-align:center;
  margin-bottom:15px;
  background: linear-gradient(90deg,#00c6ff,#0072ff);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  font-size:1.8em;
}
#chat {
  background:#1e1e1e;
  border-radius:12px;
  padding:15px;
  flex:1;
  overflow-y:auto;
  margin-bottom:15px;
  scroll-behavior:smooth;
  max-height:55vh;
}
.msg {
  margin:8px 0;
  padding:10px 14px;
  border-radius:12px;
  max-width:75%;
  animation:slideUp 0.4s ease;
  white-space:pre-line;
}
.user { background:#0072ff;color:#fff;margin-left:auto;border-bottom-right-radius:2px; }
.bot { background:#2a2a2a;color:#ddd;margin-right:auto;border-bottom-left-radius:2px; }
textarea {
  width:100%;
  border-radius:12px;
  padding:12px;
  border:none;
  resize:none;
  outline:none;
  font-size:1em;
  margin-bottom:10px;
  background:#2a2a2a;
  color:#fff;
}
button {
  margin:5px;
  padding:12px 18px;
  border:none;
  border-radius:12px;
  background:linear-gradient(90deg,#00c6ff,#0072ff);
  color:#fff;
  cursor:pointer;
  transition: transform 0.2s, box-shadow 0.2s;
}
button:hover { transform:translateY(-2px); box-shadow:0 4px 12px rgba(0,114,255,0.5); }
.quiz-btn { background: linear-gradient(90deg,#ff7e5f,#feb47b); margin:3px; }
@keyframes fadeIn { from{opacity:0; transform:scale(0.95);} to{opacity:1; transform:scale(1);} }
@keyframes slideUp { from{opacity:0; transform:translateY(10px);} to{opacity:1; transform:translateY(0);} }
@media(max-width:600px){ h1{font-size:1.4em;} button{padding:10px 12px;font-size:0.9em;} }
</style>
</head>
<body>
<div id="app">
<h1>Mega Assistant Lyc√©e + Quiz</h1>
<div id="chat"></div>
<textarea id="input" placeholder="√âcris ici..."></textarea>
<div style="text-align:center;">
  <button onclick="sendMessage()">Envoyer</button>
  <button onclick="toggleConversation()">Mode Discussion: <span id="convStatus">ON</span></button>
  <button onclick="startQuiz()">Lancer Quiz</button>
  <button onclick="showHelp()">Aide</button>
</div>
</div>
<script>
const chat = document.getElementById("chat");
const input = document.getElementById("input");
const convStatus = document.getElementById("convStatus");
let conversationMode = true;

// --- Fiches et connaissances ---
const kb = {
  maths: {
    pythagore: "Th√©or√®me de Pythagore: triangle rectangle ‚Üí c¬≤=a¬≤+b¬≤",
    trinome: "Trin√¥me ax¬≤+bx+c: Œî=b¬≤-4ac",
    derivee: "f'(x) = taux de variation de f",
    integrale: "‚à´ f(x) dx = aire sous la courbe"
  },
  physique: {
    vitesse: "v=d/t",
    acceleration: "a=Œîv/Œît",
    newton1: "Un corps reste en mouvement si aucune force",
    newton2: "F=ma",
    newton3: "Action = r√©action"
  },
  svt: {
    cellule: "Cellule: unit√© du vivant",
    adn: "ADN: information g√©n√©tique",
    mitose: "Division donnant 2 cellules identiques"
  },
  histoire: {
    revolution: "R√©volution 1789: fin Ancien R√©gime, droits de l'homme",
    napoleon: "Napol√©on 1804-1815, Code civil",
    guerre14: "1√®re Guerre mondiale 1914-1918"
  },
  francais: {
    figures: "Figures de style: m√©taphore, comparaison...",
    commentaire: "Commentaire: intro, th√®se, arguments, conclusion",
    conjugaison: "Temps: pass√© simple, imparfait, conditionnel"
  },
  anglais: {
    greetings: "Hello! Salut, bonjour.",
    verbs: "to be, to have, to do, to go",
    present: "I eat, you play, he goes"
  },
  philo: {
    liberte: "Capacit√© d'agir selon sa volont√©",
    justice: "Principe d'√©quit√©",
    bonheur: "√âtat de satisfaction raisonnable"
  }
};

// --- R√©ponses sociales ---
const social = {
  greetings:["Salut ! √áa va ?","Hey ! Ravi de te voir üëã","Yo ! Tout roule et toi ?"],
  farewell:["√Ä plus üëã","Bonne journ√©e !","Ciao, √† bient√¥t !"],
  howareyou:["√áa va nickel üòé","Je vais bien, et toi ?","Tout roule !"],
  thanks:["Avec plaisir ‚ú®","De rien üòâ","Toujours l√† üëç"]
};
const relances=["Tu veux un exercice ?","Besoin d'un rappel de cours ?","Que veux-tu r√©viser ?"];

// --- Quiz ---
const quizData = [
  {q:"Triangle rectangle, c√¥t√©s 3 et 4, hypoth√©nuse ?", a:["5","6","7"], correct:0},
  {q:"F=ma correspond √† ?", a:["Newton 1","Newton 2","Newton 3"], correct:1},
  {q:"ADN signifie ?", a:["Acide d√©soxyribonucl√©ique","Acide ribonucl√©ique","Chromosome"], correct:0}
];
let quizIndex=0;

function addMessage(text,sender){
  const div=document.createElement("div");
  div.className="msg "+sender;
  div.textContent=text;
  chat.appendChild(div);
  chat.scrollTop=chat.scrollHeight;
}

function toggleConversation(){ conversationMode=!conversationMode; convStatus.textContent=conversationMode?"ON":"OFF"; }

function detectSocial(msg){
  const l=msg.toLowerCase();
  if(/(salut|yo|hey|bonjour)/.test(l)) return "greetings";
  if(/(bye|ciao|√† plus|au revoir)/.test(l)) return "farewell";
  if(/(√ßa va|comment tu vas)/.test(l)) return "howareyou";
  if(/(merci|thanks)/.test(l)) return "thanks";
  return null;
}

function handleKnowledge(msg){
  const l=msg.toLowerCase();
  for(const s in kb){ for(const k in kb[s]){ if(l.includes(k)) return kb[s][k]; } }
  return null;
}

function handleCommands(msg){
  if(msg.startsWith("/help")) return "Commandes: /help, /calc [expr], /add [mot]=[r√©ponse]";
  if(msg.startsWith("/calc")){ try{ return "R√©sultat: "+eval(msg.replace("/calc","").trim()); }catch{return "Erreur ‚ö†Ô∏è";} }
  if(msg.startsWith("/add")){
    const parts=msg.replace("/add","").split("=");
    if(parts.length===2){ const k=parts[0].trim(); const v=parts[1].trim(); kb.custom=kb.custom||{}; kb.custom[k]=v; return `Ajout√©: ${k} ‚Üí ${v}`; }
    return "Format: /add mot=r√©ponse";
  }
  return null;
}

function handleBot(msg){
  if(conversationMode){
    const intent=detectSocial(msg);
    if(intent){
      let r=social[intent][Math.floor(Math.random()*social[intent].length)];
      if(Math.random()<0.4) r+=" "+relances[Math.floor(Math.random()*relances.length)];
      return r;
    }
  }
  const cmd=handleCommands(msg);
  if(cmd) return cmd;
  const knowledge=handleKnowledge(msg);
  if(knowledge) return knowledge;
  return "Je n'ai pas compris, je peux fournir des fiches ou lancer un quiz !";
}

function sendMessage(){
  const text=input.value.trim();
  if(!text) return;
  addMessage(text,"user");
  input.value="";
  const resp=handleBot(text);
  setTimeout(()=>addMessage(resp,"bot"),300);
}

function showHelp(){ addMessage("Commandes: /help, /calc [expr], /add [mot]=[r√©ponse]. Tu peux aussi taper un mot de cours pour r√©viser.","bot"); }

// --- Quiz ---
function startQuiz(){
  quizIndex=0;
  askQuiz();
}
function askQuiz(){
  if(quizIndex>=quizData.length){ addMessage("Quiz termin√© üéâ","bot"); return; }
  const q=quizData[quizIndex];
  addMessage("Quiz: "+q.q,"bot");
  q.a.forEach((opt,i)=>{
    const btn=document.createElement("button");
    btn.className="quiz-btn";
    btn.textContent=opt;
    btn.onclick=()=> checkQuiz(i);
    chat.appendChild(btn);
    chat.scrollTop=chat.scrollHeight;
  });
}
function checkQuiz(i){
  const q=quizData[quizIndex];
  if(i===q.correct) addMessage("‚úÖ Correct","bot");
  else addMessage("‚ùå Incorrect, bonne r√©ponse: "+q.a[q.correct],"bot");
  quizIndex++;
  askQuiz();
}

// --- Clavier Entr√©e ---
input.addEventListener("keydown",e=>{
  if(e.key==="Enter" && !e.shiftKey){ e.preventDefault(); sendMessage(); }
});

// --- Message de bienvenue ---
addMessage("Bienvenue sur Mega Assistant Lyc√©e + Quiz ! Tape /help pour commandes.","bot");
</script>
</body>
</html>
