import React, { useState, useEffect } from 'react';
import { Send, LogOut, User, Menu, X, Trash2 } from 'lucide-react';

const AssistantApp = () => {
  const [user, setUser] = useState(null);
  const [users, setUsers] = useState([
    { id: 1, username: 'admin', password: 'admin123', role: 'admin' }
  ]);
  const [loginData, setLoginData] = useState({ username: '', password: '' });
  const [messages, setMessages] = useState([]);
  const [input, setInput] = useState('');
  const [showUserManagement, setShowUserManagement] = useState(false);
  const [newUser, setNewUser] = useState({ username: '', password: '', role: 'user' });
  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);
  const [isTyping, setIsTyping] = useState(false);

  useEffect(() => {
    const savedUsers = JSON.parse(localStorage.getItem('users') || 'null');
    if (savedUsers) setUsers(savedUsers);
    const savedMessages = JSON.parse(localStorage.getItem('messages') || '[]');
    setMessages(savedMessages);
  }, []);

  const handleLogin = () => {
    const foundUser = users.find(u => u.username === loginData.username && u.password === loginData.password);
    if (foundUser) {
      setUser(foundUser);
      setLoginData({ username: '', password: '' });
    } else {
      alert('Identifiants incorrects');
    }
  };

  const handleLogout = () => {
    setUser(null);
    setMobileMenuOpen(false);
  };

  const addUser = () => {
    if (!newUser.username || !newUser.password) {
      alert('Tous les champs sont requis');
      return;
    }
    const userExists = users.some(u => u.username === newUser.username);
    if (userExists) {
      alert('Ce nom d\'utilisateur existe d√©j√†');
      return;
    }
    const updatedUsers = [...users, { ...newUser, id: Date.now() }];
    setUsers(updatedUsers);
    localStorage.setItem('users', JSON.stringify(updatedUsers));
    setNewUser({ username: '', password: '', role: 'user' });
  };

  const deleteUser = (id) => {
    if (id === 1) {
      alert('Impossible de supprimer le compte admin principal');
      return;
    }
    const updatedUsers = users.filter(u => u.id !== id);
    setUsers(updatedUsers);
    localStorage.setItem('users', JSON.stringify(updatedUsers));
  };

  const analyzeIntent = (text) => {
    const lower = text.toLowerCase();
    
    if (lower.includes('code') || lower.includes('cr√©er') || lower.includes('faire') || 
        lower.includes('bot discord') || lower.includes('site web') || lower.includes('html') || 
        lower.includes('css') || lower.includes('javascript') || lower.includes('python') ||
        lower.includes('react') || lower.includes('fonction') || lower.includes('script')) {
      return 'code';
    }
    
    if (lower.includes('image') || lower.includes('g√©n√®re') || lower.includes('dessine') || 
        lower.includes('photo') || lower.includes('illustration') || lower.includes('logo')) {
      return 'image';
    }
    
    if (lower.includes('cours') || lower.includes('le√ßon') || lower.includes('apprend') || 
        lower.includes('explique') || lower.includes('c\'est quoi') || lower.includes('math√©matique') ||
        lower.includes('physique') || lower.includes('chimie') || lower.includes('fran√ßais') ||
        lower.includes('histoire') || lower.includes('g√©ographie') || lower.includes('svt') ||
        lower.includes('biologie') || lower.includes('th√©or√®me') || lower.includes('formule') ||
        lower.includes('√©quation') || lower.includes('fonction') || lower.includes('devoir')) {
      return 'cours';
    }
    
    return 'general';
  };

  const generateResponse = (userInput, intent) => {
    const lower = userInput.toLowerCase();
    
    if (intent === 'code') {
      if (lower.includes('bot discord')) {
        return `üíª Bot Discord\n\nVoici un exemple de bot Discord fonctionnel :\n\nconst Discord = require('discord.js');\nconst client = new Discord.Client({\n  intents: ['Guilds', 'GuildMessages', 'MessageContent']\n});\n\nconst PREFIX = '!';\n\nclient.on('ready', () => {\n  console.log('Bot connect√© : ' + client.user.tag);\n});\n\nclient.on('messageCreate', message => {\n  if (message.author.bot) return;\n  \n  if (message.content.startsWith(PREFIX + 'ping')) {\n    message.reply('üèì Pong!');\n  }\n  \n  if (message.content.startsWith(PREFIX + 'hello')) {\n    message.reply('Salut ' + message.author.username + '! üëã');\n  }\n});\n\nclient.login('TON_TOKEN_ICI');\n\nInstallation :\nnpm install discord.js\nnode bot.js\n\nPour le token : Va sur Discord Developer Portal > New Application > Bot > Copy Token`;
      }
      
      if (lower.includes('site') || lower.includes('page web') || lower.includes('html')) {
        return `üåê Site Web Moderne\n\nVoici un template de site complet :\n\n<!DOCTYPE html>\n<html lang="fr">\n<head>\n  <meta charset="UTF-8">\n  <meta name="viewport" content="width=device-width, initial-scale=1.0">\n  <title>Mon Site</title>\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    body {\n      font-family: 'Arial', sans-serif;\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      min-height: 100vh;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n    .container {\n      background: rgba(255,255,255,0.1);\n      backdrop-filter: blur(10px);\n      padding: 40px;\n      border-radius: 20px;\n      box-shadow: 0 8px 32px rgba(0,0,0,0.3);\n      text-align: center;\n      color: white;\n    }\n    h1 { font-size: 3em; margin-bottom: 20px; }\n    button {\n      background: white;\n      color: #667eea;\n      border: none;\n      padding: 15px 30px;\n      font-size: 1.2em;\n      border-radius: 50px;\n      cursor: pointer;\n      transition: transform 0.3s;\n    }\n    button:hover { transform: scale(1.1); }\n  </style>\n</head>\n<body>\n  <div class="container">\n    <h1>üöÄ Bienvenue !</h1>\n    <p>Mon site super cool</p>\n    <button onclick="alert('Hello!')">Clique-moi</button>\n  </div>\n</body>\n</html>\n\n√áa cr√©e un site moderne avec effet glassmorphism ! üé®`;
      }
      
      if (lower.includes('python')) {
        return `üêç Script Python\n\nVoici un exemple adapt√© √† ta demande :\n\nimport os\nimport time\nfrom datetime import datetime\n\ndef main():\n    print("üöÄ Script d√©marr√© !\\n")\n    \n    def saluer(nom):\n        heure = datetime.now().hour\n        if heure < 12:\n            return f"‚òÄÔ∏è Bonjour {nom}!"\n        elif heure < 18:\n            return f"üå§Ô∏è Bon apr√®s-midi {nom}!"\n        else:\n            return f"üåô Bonsoir {nom}!"\n    \n    nom = input("Ton nom : ")\n    print(saluer(nom))\n    \n    for i in range(5, 0, -1):\n        print(f"‚è∞ {i}...")\n        time.sleep(1)\n    \n    print("‚úÖ Termin√©!\\n")\n\nif __name__ == "__main__":\n    main()\n\nEx√©cution : python script.py`;
      }
      
      return `üíª Code Personnalis√©\n\nconst maFonction = () => {\n  console.log('‚ú® Fonction cr√©√©e!');\n  \n  let data = [];\n  \n  const processData = (input) => {\n    return input.map(item => item * 2);\n  };\n  \n  return {\n    success: true,\n    message: 'Op√©ration r√©ussie',\n    data: processData(data)\n  };\n};\n\nconst result = maFonction();\nconsole.log(result);\n\nDis-moi exactement ce que tu veux faire pour un code plus pr√©cis ! üéØ`;
    }
    
    if (intent === 'image') {
      const subject = userInput.replace(/g√©n√®re|cr√©e|fais|image|photo|de|un|une/gi, '').trim();
      return `üé® G√©n√©ration d'Image : ${subject}\n\nüñºÔ∏è Prompt optimis√© pour DALL-E / Midjourney :\n"A highly detailed digital illustration of ${subject}, professional photography, 8k resolution, cinematic lighting, vibrant colors, trending on artstation"\n\nüìù Prompts alternatifs :\n1. "${subject}, digital art, fantasy style, epic composition"\n2. "${subject}, photorealistic, studio lighting, high quality"\n3. "${subject}, concept art, detailed, colorful"\n\nüîß APIs Gratuites pour g√©n√©rer l'image :\n\n1. Hugging Face (Stable Diffusion) :\nimport requests\n\nAPI_URL = "https://api-inference.huggingface.co/models/stabilityai/stable-diffusion-2"\nheaders = {"Authorization": "Bearer TON_TOKEN"}\n\ndef generate_image(prompt):\n    response = requests.post(API_URL, headers=headers, json={"inputs": prompt})\n    with open("image.png", "wb") as f:\n        f.write(response.content)\n\ngenerate_image("${subject}, detailed, 4k")\n\n2. Via site web gratuit :\n‚Ä¢ Craiyon.com (gratuit)\n‚Ä¢ Leonardo.ai (15 cr√©dits/jour)\n‚Ä¢ Playground AI (gratuit)\n\nVa sur un de ces sites et colle le prompt ! üöÄ`;
    }
    
    if (intent === 'cours') {
      if (lower.includes('math')) {
        if (lower.includes('fonction') || lower.includes('second degr√©') || lower.includes('√©quation')) {
          return `üìê Cours : Fonctions du Second Degr√© (Seconde)\n\nüìå D√©finition :\nUne fonction du second degr√© (ou trin√¥me) est de la forme :\nf(x) = ax¬≤ + bx + c o√π a ‚â† 0\n\nüéØ Forme canonique :\nf(x) = a(x - Œ±)¬≤ + Œ≤\n\nAvec :\n‚Ä¢ Œ± = -b/(2a) (abscisse du sommet)\n‚Ä¢ Œ≤ = f(Œ±) (ordonn√©e du sommet)\n\nüìä Variations :\n‚Ä¢ Si a > 0 : parabole tourn√©e vers le haut ‚§¥Ô∏è\n  - Minimum en (Œ±, Œ≤)\n‚Ä¢ Si a < 0 : parabole tourn√©e vers le bas ‚§µÔ∏è\n  - Maximum en (Œ±, Œ≤)\n\nüîç Discriminant Œî (Delta) :\nŒî = b¬≤ - 4ac\n\n‚Ä¢ Œî > 0 ‚Üí 2 solutions : x‚ÇÅ = (-b-‚àöŒî)/(2a) et x‚ÇÇ = (-b+‚àöŒî)/(2a)\n‚Ä¢ Œî = 0 ‚Üí 1 solution : x = -b/(2a)\n‚Ä¢ Œî < 0 ‚Üí Pas de solution r√©elle\n\nüí° Exemple :\nR√©soudre : x¬≤ - 5x + 6 = 0\n\na=1, b=-5, c=6\nŒî = (-5)¬≤ - 4(1)(6) = 25 - 24 = 1\nŒî > 0 ‚Üí 2 solutions\n\nx‚ÇÅ = (5-1)/2 = 2\nx‚ÇÇ = (5+1)/2 = 3\n\nSolutions : {2 ; 3} ‚úÖ\n\nüìù √Ä retenir :\n‚Ä¢ Toujours calculer Œî d'abord\n‚Ä¢ Le sommet donne le point remarquable\n‚Ä¢ La factorisation : a(x-x‚ÇÅ)(x-x‚ÇÇ) si Œî ‚â• 0`;
        }
        
        return `üìê Math√©matiques - Niveau Seconde\n\nChapitres principaux :\n\n1Ô∏è‚É£ Fonctions\n‚Ä¢ D√©finition et notation f(x)\n‚Ä¢ Ensemble de d√©finition\n‚Ä¢ Tableau de variations\n‚Ä¢ Fonctions affines : f(x) = ax + b\n‚Ä¢ Fonctions du second degr√© : f(x) = ax¬≤ + bx + c\n\n2Ô∏è‚É£ √âquations\n‚Ä¢ √âquations du 1er degr√©\n‚Ä¢ √âquations du 2nd degr√© (discriminant Œî)\n‚Ä¢ Syst√®mes d'√©quations\n\n3Ô∏è‚É£ Vecteurs\n‚Ä¢ D√©finition et notation\n‚Ä¢ Coordonn√©es d'un vecteur\n‚Ä¢ Addition et multiplication par un scalaire\n‚Ä¢ Colin√©arit√©\n\n4Ô∏è‚É£ G√©om√©trie\n‚Ä¢ Th√©or√®me de Pythagore\n‚Ä¢ Trigonom√©trie (sin, cos, tan)\n‚Ä¢ Angles et cercles\n\nüí° Sur quel chapitre veux-tu un cours d√©taill√© ?`;
      }
      
      if (lower.includes('physique') || lower.includes('chimie')) {
        return `‚öõÔ∏è Physique-Chimie - Niveau Seconde\n\nPHYSIQUE üî¨\n\n1Ô∏è‚É£ M√©canique\n‚Ä¢ Mouvement et vitesse : v = d/t\n‚Ä¢ Acc√©l√©ration\n‚Ä¢ Principe d'inertie (1√®re loi de Newton)\n‚Ä¢ Forces et interactions\n\n2Ô∏è‚É£ √âlectricit√©\n‚Ä¢ Tension √©lectrique (U en Volts)\n‚Ä¢ Intensit√© (I en Amp√®res)\n‚Ä¢ Loi d'Ohm : U = R √ó I\n‚Ä¢ Circuits en s√©rie et parall√®le\n‚Ä¢ Puissance : P = U √ó I (en Watts)\n\nCHIMIE üß™\n\n1Ô∏è‚É£ Atomes et Mol√©cules\n‚Ä¢ Structure de l'atome (protons, neutrons, √©lectrons)\n‚Ä¢ Num√©ro atomique Z\n‚Ä¢ Masse atomique A\n‚Ä¢ Formules chimiques : H‚ÇÇO, CO‚ÇÇ, etc.\n\n2Ô∏è‚É£ Transformations Chimiques\n‚Ä¢ R√©actifs ‚Üí Produits\n‚Ä¢ Conservation de la masse\n‚Ä¢ √âquations chimiques √† √©quilibrer\n\n3Ô∏è‚É£ Solutions Aqueuses\n‚Ä¢ Concentration (mol/L)\n‚Ä¢ Dilution : C‚ÇÅV‚ÇÅ = C‚ÇÇV‚ÇÇ\n‚Ä¢ pH (acide < 7 < basique)\n\nüí° Formules essentielles :\n‚Ä¢ v = d/t (vitesse)\n‚Ä¢ U = R √ó I (loi d'Ohm)\n‚Ä¢ P = U √ó I (puissance)\n‚Ä¢ E = m √ó g √ó h (√©nergie potentielle)\n\nQuel chapitre d√©tailler ? üéØ`;
      }
      
      if (lower.includes('fran√ßais')) {
        return `üìö Fran√ßais - Niveau Seconde\n\n1Ô∏è‚É£ Analyse de Texte\n\nLes figures de style :\n‚Ä¢ M√©taphore : comparaison sans "comme"\n  Ex: "Sa voix est du miel" üçØ\n‚Ä¢ Comparaison : avec "comme", "tel que"\n  Ex: "Doux comme un agneau"\n‚Ä¢ Personnification : donner vie √† un objet\n  Ex: "Le vent hurle"\n‚Ä¢ Hyperbole : exag√©ration\n  Ex: "Mourir de rire"\n\n2Ô∏è‚É£ Les Types de Textes\n‚Ä¢ Narratif : raconte une histoire\n‚Ä¢ Descriptif : d√©crit (lieux, personnes)\n‚Ä¢ Argumentatif : convainc, d√©bat\n‚Ä¢ Explicatif : informe, explique\n\n3Ô∏è‚É£ Grammaire\n\nClasses grammaticales :\n‚Ä¢ Nom, verbe, adjectif, adverbe\n‚Ä¢ Pronom, d√©terminant, pr√©position\n‚Ä¢ Conjonction, interjection\n\nConjugaison importante :\n‚Ä¢ Pr√©sent, imparfait, pass√© simple\n‚Ä¢ Futur, conditionnel\n‚Ä¢ Subjonctif (il faut que je...)\n\n4Ô∏è‚É£ M√©thodologie\n\nCommentaire compos√© :\n1. Introduction (amorce, pr√©sentation, probl√©matique)\n2. D√©veloppement (2-3 parties)\n3. Conclusion (bilan + ouverture)\n\nDissertation :\n1. Th√®se\n2. Antith√®se\n3. Synth√®se\n\nüí° Astuce : Toujours citer le texte entre guillemets ! üìù`;
      }
      
      return `üéì Cours Niveau Seconde\n\nJe peux t'aider dans toutes les mati√®res :\n\nüìê Math√©matiques\n‚Ä¢ Fonctions, √©quations, g√©om√©trie\n\n‚öõÔ∏è Physique-Chimie\n‚Ä¢ M√©canique, √©lectricit√©, atomes\n\nüìö Fran√ßais\n‚Ä¢ Analyse litt√©raire, grammaire\n\nüåç Histoire-G√©o\n‚Ä¢ √âv√©nements, cartes, dates\n\nüß¨ SVT\n‚Ä¢ Biologie, g√©ologie, √©cosyst√®mes\n\nPose-moi une question pr√©cise sur un chapitre ! üí°\nExemple : "Explique-moi les fonctions du second degr√©"`;
    }
    
    return `Je suis l√† pour t'aider ! üòä\n\n‚ú® Je peux :\n‚Ä¢ üìö T'expliquer des cours (maths, physique, fran√ßais...)\n‚Ä¢ üíª Coder tes projets (sites, bots Discord, Python...)\n‚Ä¢ üé® Te donner des prompts pour g√©n√©rer des images\n‚Ä¢ üí° R√©pondre √† tes questions\n\nExemples de questions :\n‚Ä¢ "Explique-moi les √©quations du second degr√©"\n‚Ä¢ "Code-moi un bot Discord avec commande !ping"\n‚Ä¢ "G√©n√®re une image de dragon futuriste"\n‚Ä¢ "Cr√©e un site web moderne"\n\nTa question : "${userInput}"\n\nPeux-tu √™tre plus pr√©cis sur ce que tu veux ? üéØ`;
  };

  const sendMessage = () => {
    if (!input.trim()) return;

    const userMessage = { role: 'user', content: input };
    const updatedMessages = [...messages, userMessage];
    setMessages(updatedMessages);
    
    const currentInput = input;
    setInput('');
    setIsTyping(true);

    setTimeout(() => {
      const intent = analyzeIntent(currentInput);
      const botResponse = generateResponse(currentInput, intent);
      
      const botMessage = { role: 'assistant', content: botResponse };
      const finalMessages = [...updatedMessages, botMessage];
      setMessages(finalMessages);
      localStorage.setItem('messages', JSON.stringify(finalMessages));
      setIsTyping(false);
    }, 1000);
  };

  const clearChat = () => {
    setMessages([]);
    localStorage.setItem('messages', JSON.stringify([]));
  };

  const handleKeyPress = (e) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      if (user) {
        sendMessage();
      } else {
        handleLogin();
      }
    }
  };

  if (!user) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-800 flex items-center justify-center p-4">
        <div className="bg-white/10 backdrop-blur-lg rounded-2xl p-8 w-full max-w-md border border-white/20 shadow-2xl">
          <div className="text-center mb-6">
            <div className="text-6xl mb-4">ü§ñ</div>
            <h1 className="text-3xl font-bold text-white">Mon Assistant IA</h1>
            <p className="text-white/60 mt-2">Connexion requise</p>
          </div>
          <div className="space-y-4">
            <input
              type="text"
              placeholder="Nom d'utilisateur"
              value={loginData.username}
              onChange={(e) => setLoginData({...loginData, username: e.target.value})}
              onKeyPress={handleKeyPress}
              className="w-full px-4 py-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-purple-400"
            />
            <input
              type="password"
              placeholder="Mot de passe"
              value={loginData.password}
              onChange={(e) => setLoginData({...loginData, password: e.target.value})}
              onKeyPress={handleKeyPress}
              className="w-full px-4 py-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-purple-400"
            />
            <button onClick={handleLogin} className="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-semibold py-3 rounded-lg transition shadow-lg">
              Se connecter
            </button>
          </div>
          <p className="text-white/60 text-sm mt-4 text-center">Compte par d√©faut: admin / admin123</p>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-800 flex flex-col">
      <header className="bg-white/10 backdrop-blur-lg border-b border-white/20 p-4 shadow-lg">
        <div className="max-w-6xl mx-auto flex items-center justify-between">
          <div className="flex items-center gap-3">
            <div className="text-3xl">ü§ñ</div>
            <div>
              <h1 className="text-xl font-bold text-white">Assistant IA</h1>
              <p className="text-white/60 text-xs">Intelligent & Polyvalent</p>
            </div>
          </div>
          <div className="flex items-center gap-2">
            <span className="text-white/80 text-sm hidden sm:inline">{user.username}</span>
            <button onClick={() => setMobileMenuOpen(!mobileMenuOpen)} className="sm:hidden text-white p-2">
              {mobileMenuOpen ? <X size={24} /> : <Menu size={24} />}
            </button>
            <button onClick={handleLogout} className="hidden sm:flex items-center gap-2 bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition">
              <LogOut size={18} />
            </button>
          </div>
        </div>
        
        {mobileMenuOpen && (
          <div className="sm:hidden mt-4 space-y-2">
            <button onClick={handleLogout} className="w-full flex items-center justify-center gap-2 bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition">
              <LogOut size={18} />
              D√©connexion
            </button>
            {user.role === 'admin' && (
              <button onClick={() => { setShowUserManagement(!showUserManagement); setMobileMenuOpen(false); }} className="w-full flex items-center justify-center gap-2 bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition">
                <User size={18} />
                {showUserManagement ? 'Chat' : 'G√©rer Utilisateurs'}
              </button>
            )}
          </div>
        )}
      </header>

      {user.role === 'admin' && showUserManagement ? (
        <div className="flex-1 p-4 overflow-y-auto">
          <div className="max-w-4xl mx-auto bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20">
            <div className="flex items-center justify-between mb-6">
              <h2 className="text-2xl font-bold text-white">Gestion des Utilisateurs</h2>
              <button onClick={() => setShowUserManagement(false)} className="hidden sm:block bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg transition">
                Retour au Chat
              </button>
            </div>

            <div className="bg-white/5 p-4 rounded-lg mb-6">
              <h3 className="text-white font-semibold mb-3">Ajouter un utilisateur</h3>
              <div className="grid grid-cols-1 sm:grid-cols-3 gap-3">
                <input
                  type="text"
                  placeholder="Nom d'utilisateur"
                  value={newUser.username}
                  onChange={(e) => setNewUser({...newUser, username: e.target.value})}
                  className="px-3 py-2 rounded bg-white/20 border border-white/30 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-purple-400"
                />
                <input
                  type="password"
                  placeholder="Mot de passe"
                  value={newUser.password}
                  onChange={(e) => setNewUser({...newUser, password: e.target.value})}
                  className="px-3 py-2 rounded bg-white/20 border border-white/30 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-purple-400"
                />
                <button onClick={addUser} className="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded transition">
                  Ajouter
                </button>
              </div>
            </div>

            <div className="space-y-2">
              {users.map(u => (
                <div key={u.id} className="bg-white/5 p-4 rounded-lg flex items-center justify-between">
                  <div>
                    <p className="text-white font-semibold">{u.username}</p>
                    <p className="text-white/60 text-sm">{u.role === 'admin' ? 'Admin' : 'Utilisateur'}</p>
                  </div>
                  {u.id !== 1 && (
                    <button onClick={() => deleteUser(u.id)} className="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm transition flex items-center gap-1">
                      <Trash2 size={14} />
                      Supprimer
                    </button>
                  )}
                </div>
              ))}
            </div>
          </div>
        </div>
      ) : (
        <>
          <div className="flex-1 overflow-y-auto p-4">
            <div className="max-w-4xl mx-auto space-y-4 pb-4">
              {messages.length === 0 ? (
                <div className="text-center text-white mt-20">
                  <div className="text-6xl mb-6">‚ú®</div>
                  <h2 className="text-3xl font-bold mb-4">Bonjour {user.username} !</h2>
                  <p className="text-white/70 text-lg mb-8">Je suis ton assistant personnel intelligent</p>
                  
                  <div className="grid grid-cols-1 md:grid-cols-3 gap-4 max-w-3xl mx-auto">
                    <div className="bg-white/10 backdrop-blur-lg p-6 rounded-xl border border-white/20">
                      <div className="text-4xl mb-3">üìö</div>
                      <h3 className="font-bold mb-2">Cours & Le√ßons</h3>
                      <p className="text-sm text-white/70">Explications niveau Seconde</p>
                    </div>
                    <div className="bg-white/10 backdrop-blur-lg p-6 rounded-xl border border-white/20">
                      <div className="text-4xl mb-3">üíª</div>
                      <h3 className="font-bold mb-2">Code & Dev</h3>
                      <p className="text-sm text-white/70">Sites, bots, scripts...</p>
                    </div>
                    <div className="bg-white/10 backdrop-blur-lg p-6 rounded-xl border border-white/20">
                      <div className="text-4xl mb-3">üé®</div>
                      <h3 className="font-bold mb-2">Images IA</h3>
                      <p className="text-sm text-white/70">Prompts optimis√©s</p>
                    </div>
                  </div>
                  
                  <div className="mt-8 text-white/60">
                    <p className="mb-2">üí° Exemples de questions :</p>
                    <div className="space-y-1 text-sm">
                      <p>‚Ä¢ "Explique-moi les fon
